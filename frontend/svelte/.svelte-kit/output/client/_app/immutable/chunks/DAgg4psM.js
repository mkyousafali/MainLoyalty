import{w as g}from"./CmJYm0S5.js";import{b as r}from"./Bt-Xh7oU.js";import{s as l}from"./CIOq__Tp.js";const o={whatsappSupportLink:"https://wa.me/966112345678"};function u(){const{subscribe:p,set:s,update:i}=g(o);return{subscribe:p,loadGlobalSettings:async()=>{try{console.log("🔄 Loading global settings from database...");const{data:t,error:a}=await l.from("global_settings").select("setting_key, setting_value").in("setting_key",["whatsapp_support_link"]);if(a){if(console.warn("⚠️ Failed to load global settings from database:",a.message),r){const e=localStorage.getItem("globalWhatsAppSupportLink");if(e){s({whatsappSupportLink:e});return}}s(o);return}if(t&&t.length>0){console.log("✅ Global settings loaded from database");const e={whatsappSupportLink:o.whatsappSupportLink};t.forEach(n=>{n.setting_key==="whatsapp_support_link"&&n.setting_value&&(e.whatsappSupportLink=n.setting_value)}),s(e)}else console.warn("⚠️ No global settings found in database, using defaults"),s(o)}catch(t){console.error("❌ Failed to load global settings:",t);try{const a=localStorage.getItem("globalWhatsAppSupportLink");if(a){s({whatsappSupportLink:a});return}}catch(a){console.warn("Failed to load global settings from localStorage:",a)}s(o)}},getWhatsAppLink:async()=>{try{const{data:t,error:a}=await l.from("global_settings").select("setting_value").eq("setting_key","whatsapp_support_link").single();if(a||!t?.setting_value){if(console.warn("Failed to get WhatsApp link from database, using fallback"),r){const e=localStorage.getItem("globalWhatsAppSupportLink");if(e)return e}return o.whatsappSupportLink}return t.setting_value}catch(t){return console.error("Error getting WhatsApp link:",t),o.whatsappSupportLink}},updateWhatsAppLink:t=>{i(a=>({...a,whatsappSupportLink:t}))}}}const c=u();async function d(){return await c.getWhatsAppLink()}export{d as g};
