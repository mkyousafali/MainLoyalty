import"../chunks/DsnmJJEf.js";import"../chunks/69_IOA4Y.js";import{o as kt}from"../chunks/Y1pQyyvi.js";import{l as Dt,m as v,t as D,x as Et,n as l,o as Mt,w as r,v as e,a,y as j,B as g,s as f,z as t,H as dt,C as lt}from"../chunks/Ck91ypkQ.js";import{i as T}from"../chunks/RujGBxXx.js";import{e as ot,i as vt}from"../chunks/D775oJua.js";import{i as zt}from"../chunks/6tn_K0LM.js";import{s as nt}from"../chunks/CIOq__Tp.js";var Bt=v('<div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"></div>'),Kt=v('<span class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg></span>'),jt=v('<span class="w-6 h-6 bg-red-500 rounded-full flex items-center justify-center"><svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></span>'),At=v('<div class="p-8 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="text-gray-600 mt-2">Testing database tables...</p></div>'),Ft=v('<div class="p-8 text-center text-gray-500">No table results available. Click "Retest Connection" to try again.</div>'),Nt=v('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg> OK</span>'),Ht=v('<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"><svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg> ERROR</span>'),It=v('<span class="text-green-600">Accessible</span>'),Pt=v('<span class="text-red-600"> </span>'),Qt=v('<tr class="hover:bg-gray-50"><td class="px-6 py-4 whitespace-nowrap"><!></td><td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500"> </td><td class="px-6 py-4 text-sm text-gray-500"><!></td></tr>'),Ut=v('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Table Name</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Record Count</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Details</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div>'),qt=v('<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6"><div class="bg-white rounded-lg shadow p-6"><div class="flex items-center"><div class="text-2xl text-green-600 mr-4">‚úÖ</div> <div><p class="text-sm font-medium text-gray-500">Successful Tables</p> <p class="text-2xl font-bold text-gray-900"> </p></div></div></div> <div class="bg-white rounded-lg shadow p-6"><div class="flex items-center"><div class="text-2xl text-red-600 mr-4">‚ùå</div> <div><p class="text-sm font-medium text-gray-500">Failed Tables</p> <p class="text-2xl font-bold text-gray-900"> </p></div></div></div> <div class="bg-white rounded-lg shadow p-6"><div class="flex items-center"><div class="text-2xl text-blue-600 mr-4">üìä</div> <div><p class="text-sm font-medium text-gray-500">Total Records</p> <p class="text-2xl font-bold text-gray-900"> </p></div></div></div></div>'),Gt=v('<div class="bg-red-50 border border-red-200 rounded-lg p-4"><code class="text-red-800 text-sm"> </code></div>'),Jt=v('<div class="mb-6"><div class="bg-white rounded-lg shadow overflow-hidden"><div class="px-6 py-4 border-b border-gray-200"><h2 class="text-xl font-semibold text-red-600">Errors Detected</h2> <p class="text-sm text-gray-600 mt-1"> </p></div> <div class="p-6"><div class="space-y-3"></div></div></div></div>'),Vt=v('<div class="p-6"><div class="max-w-4xl mx-auto"><div class="mb-8"><div class="flex justify-between items-center"><div><h1 class="text-3xl font-bold text-gray-900 mb-2">Database Connection Test</h1> <p class="text-gray-600">Test database connectivity and table accessibility.</p></div> <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50"> </button></div></div> <div class="mb-6"><div class="bg-white rounded-lg shadow p-6"><h2 class="text-xl font-semibold mb-4">Connection Status</h2> <div class="flex items-center space-x-3"><!> <span class="text-lg font-medium"> </span></div></div></div> <div class="mb-6"><div class="bg-white rounded-lg shadow overflow-hidden"><div class="px-6 py-4 border-b border-gray-200"><h2 class="text-xl font-semibold">Tables Status</h2> <p class="text-sm text-gray-600 mt-1">Status of all database tables</p></div> <!></div></div> <!> <!> <div class="bg-gray-50 rounded-lg p-6"><h3 class="text-lg font-semibold mb-4">Database Information</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm"><div><span class="font-medium text-gray-700">Database Type:</span> <span class="text-gray-600 ml-2">Supabase PostgreSQL</span></div> <div><span class="font-medium text-gray-700">Connection Method:</span> <span class="text-gray-600 ml-2">Supabase Client</span></div> <div><span class="font-medium text-gray-700">Test Date:</span> <span class="text-gray-600 ml-2"> </span></div> <div><span class="font-medium text-gray-700">Tables Tested:</span> <span class="text-gray-600 ml-2"> </span></div></div></div></div></div>');function se(ct,pt){Dt(pt,!1);let x=j([]),y=j([]),w=j(!0),O=j("Testing...");kt(async()=>{await Q(),await U(),f(w,!1)});async function Q(){try{const{data:s,error:i}=await nt.auth.getSession();i?(f(O,"Connection Error"),a(y).push(`Connection: ${i.message}`)):f(O,"Connected Successfully")}catch(s){f(O,"Connection Failed"),a(y).push(`Connection: ${s.message}`)}}async function U(){const s=["roles","branches","users","customer_numbers","card_types","customers","transactions","coupons","coupon_usage","reward_categories","rewards","gifts","notifications"];f(x,[]);for(const i of s)try{const{data:n,error:c,count:m}=await nt.from(i).select("*",{count:"exact",head:!0});c?(a(y).push(`${i}: ${c.message}`),a(x).push({table:i,count:0,status:"ERROR",error:c.message})):a(x).push({table:i,count:m||0,status:"OK"})}catch(n){a(y).push(`${i}: ${n.message}`),a(x).push({table:i,count:0,status:"ERROR",error:n.message})}}async function xt(){f(w,!0),f(y,[]),f(x,[]),f(O,"Testing..."),await Q(),await U(),f(w,!1)}zt();var A=Vt(),q=e(A),F=e(q),G=e(F),M=r(e(G),2),ut=e(M,!0);t(M),t(G),t(F);var N=r(F,2),J=e(N),V=r(e(J),2),W=e(V);{var gt=s=>{var i=Bt();l(s,i)},mt=s=>{var i=dt(),n=lt(i);{var c=d=>{var p=Kt();l(d,p)},m=d=>{var p=jt();l(d,p)};T(n,d=>{a(O).includes("Success")?d(c):d(m,!1)},!0)}l(s,i)};T(W,s=>{a(w)?s(gt):s(mt,!1)})}var X=r(W,2),ft=e(X,!0);t(X),t(V),t(J),t(N);var H=r(N,2),Y=e(H),bt=r(e(Y),2);{var _t=s=>{var i=At();l(s,i)},ht=s=>{var i=dt(),n=lt(i);{var c=d=>{var p=Ft();l(d,p)},m=d=>{var p=Ut(),b=e(p),L=r(e(b));ot(L,5,()=>a(x),vt,(k,u)=>{var C=Qt(),R=e(C),z=e(R);{var B=o=>{var h=Nt();l(o,h)},K=o=>{var h=Ht();l(o,h)};T(z,o=>{a(u).status==="OK"?o(B):o(K,!1)})}t(R);var E=r(R),_=e(E,!0);t(E);var S=r(E),P=e(S);t(S);var it=r(S),Tt=e(it);{var Lt=o=>{var h=It();l(o,h)},St=o=>{var h=Pt(),Ot=e(h,!0);t(h),D(()=>g(Ot,a(u).error||"Unknown error")),l(o,h)};T(Tt,o=>{a(u).status==="OK"?o(Lt):o(St,!1)})}t(it),t(C),D(o=>{g(_,a(u).table),g(P,`${o??""} records`)},[()=>a(u).count.toLocaleString()]),l(k,C)}),t(L),t(b),t(p),l(d,p)};T(n,d=>{a(x).length===0?d(c):d(m,!1)},!0)}l(s,i)};T(bt,s=>{a(w)?s(_t):s(ht,!1)})}t(Y),t(H);var Z=r(H,2);{var yt=s=>{var i=qt(),n=e(i),c=e(n),m=r(e(c),2),d=r(e(m),2),p=e(d,!0);t(d),t(m),t(c),t(n);var b=r(n,2),L=e(b),k=r(e(L),2),u=r(e(k),2),C=e(u,!0);t(u),t(k),t(L),t(b);var R=r(b,2),z=e(R),B=r(e(z),2),K=r(e(B),2),E=e(K,!0);t(K),t(B),t(z),t(R),t(i),D((_,S,P)=>{g(p,_),g(C,S),g(E,P)},[()=>a(x).filter(_=>_.status==="OK").length,()=>a(x).filter(_=>_.status==="ERROR").length,()=>a(x).reduce((_,S)=>_+S.count,0).toLocaleString()]),l(s,i)};T(Z,s=>{!a(w)&&a(x).length>0&&s(yt)})}var $=r(Z,2);{var wt=s=>{var i=Jt(),n=e(i),c=e(n),m=r(e(c),2),d=e(m);t(m),t(c);var p=r(c,2),b=e(p);ot(b,5,()=>a(y),vt,(L,k)=>{var u=Gt(),C=e(u),R=e(C,!0);t(C),t(u),D(()=>g(R,a(k))),l(L,u)}),t(b),t(p),t(n),t(i),D(()=>g(d,`${a(y).length??""} error(s) found during testing`)),l(s,i)};T($,s=>{a(y).length>0&&s(wt)})}var tt=r($,2),et=r(e(tt),2),I=r(e(et),4),at=r(e(I),2),Ct=e(at,!0);t(at),t(I);var st=r(I,2),rt=r(e(st),2),Rt=e(rt);t(rt),t(st),t(et),t(tt),t(q),t(A),D(s=>{M.disabled=a(w),g(ut,a(w)?"Testing...":"Retest Connection"),g(ft,a(O)),g(Ct,s),g(Rt,`${a(x).length??""} tables`)},[()=>new Date().toLocaleString()]),Et("click",M,xt),l(ct,A),Mt()}export{se as component};
