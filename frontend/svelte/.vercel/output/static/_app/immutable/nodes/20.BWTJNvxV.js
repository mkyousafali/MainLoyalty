import"../chunks/DsnmJJEf.js";import"../chunks/69_IOA4Y.js";import{o as vr}from"../chunks/Y1pQyyvi.js";import{l as ur,q as Fe,r as mr,m as y,J as pr,t as h,v as a,w as i,a as e,n as p,o as fr,y as _,$ as gr,s as v,I as O,z as t,A as Re,B as w,u,H as Ut,C as ct,K as Ct,E as me,x as D,F as Et,b as br,G as vt}from"../chunks/Ck91ypkQ.js";import{i as I}from"../chunks/RujGBxXx.js";import{e as ut,i as mt}from"../chunks/D775oJua.js";import{r as q,a as $e}from"../chunks/DvH4tfbe.js";import{s as Tt}from"../chunks/B38bOHRo.js";import{a as E,c as xr}from"../chunks/C4HntxLm.js";import{b as Le}from"../chunks/xkiwYR4x.js";import{p as _r}from"../chunks/D4Caz1gY.js";import{i as yr}from"../chunks/6tn_K0LM.js";import{g as hr}from"../chunks/Bc_wzfnz.js";import{s as K}from"../chunks/CIOq__Tp.js";var wr=y("<option> </option>"),Pr=y('<div class="p-8 text-center"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"></div> <p class="text-gray-600 mt-4">Loading offers...</p></div>'),kr=y('<div class="p-8 text-center"><div class="text-gray-400 text-6xl mb-4">📋</div> <h3 class="text-lg font-semibold text-gray-900 mb-2">No offers found</h3> <p class="text-gray-600 mb-4"> </p></div>'),Dr=y('<img class="w-12 h-12 rounded-lg object-cover mr-4"/>'),Or=y('<div class="w-12 h-12 bg-gray-200 rounded-lg flex items-center justify-center mr-4 text-gray-400">📷</div>'),Sr=y('<div class="text-sm text-gray-500"> </div>'),Fr=y('<tr class="hover:bg-gray-50"><td class="px-6 py-4"><div class="flex items-center"><!> <div><div class="text-sm font-medium text-gray-900"> </div> <!></div></div></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"><!></td><td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900"> </td><td class="px-6 py-4 whitespace-nowrap"><span> </span></td><td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium"><div class="flex items-center justify-end space-x-2"><button class="text-blue-600 hover:text-blue-800 transition-colors p-1" title="Edit Offer">✏️</button> <button class="text-gray-600 hover:text-gray-800 transition-colors p-1"> </button> <button class="text-red-600 hover:text-red-800 transition-colors p-1" title="Delete Offer">🗑️</button></div></td></tr>'),Ar=y('<div class="bg-white px-4 py-3 border-t border-gray-200 sm:px-6"><div class="flex items-center justify-between"><div class="flex items-center text-sm text-gray-700"> </div> <div class="flex items-center space-x-2"><button class="px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 transition-colors">Previous</button> <span class="px-4 py-2 text-sm text-gray-700"> </span> <button class="px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 transition-colors">Next</button></div></div></div>'),Ir=y('<div class="overflow-x-auto"><table class="min-w-full divide-y divide-gray-200"><thead class="bg-gray-50"><tr><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Offer</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Branch</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Discount</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valid Until</th><th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th><th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th></tr></thead><tbody class="bg-white divide-y divide-gray-200"></tbody></table></div> <!>',1),Br=y("<option> </option>"),Mr=y('<div class="relative mb-3"><img alt="Offer preview" class="w-full h-48 object-cover rounded-lg border"/> <button type="button" class="absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors">✕</button></div>'),Ur=y('<div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors"><div class="text-gray-400 mb-2 text-4xl">📷</div> <p class="text-sm text-gray-600 mb-4">Upload an image for your offer</p></div>'),Cr=y('<div class="border rounded-lg p-4 bg-gray-50 mb-3"><div class="flex items-center space-x-3"><span class="text-red-600 text-2xl">📄</span> <div class="flex-1"><p class="text-sm font-medium text-gray-900"> </p> <p class="text-xs text-gray-500">PDF Document</p></div> <button type="button" class="text-red-500 hover:text-red-700 transition-colors">✕</button></div></div>'),Er=y('<div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors"><div class="text-gray-400 mb-2 text-4xl">📄</div> <p class="text-sm text-gray-600 mb-4">Upload a PDF with offer details</p></div>'),Tr=y('<div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div> <span>Creating...</span>',1),Nr=y("<span>Create Offer</span>"),Rr=y('<div class="fixed inset-0 z-50 overflow-y-auto"><div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"><div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div> <div class="inline-block align-bottom bg-white rounded-xl px-6 pt-6 pb-6 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-5xl sm:w-full"><div class="absolute top-0 right-0 pt-4 pr-4"><button class="bg-white rounded-md text-gray-400 hover:text-gray-600 focus:outline-none"><span class="sr-only">Close</span> <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="mb-8"><h1 class="text-3xl font-bold text-gray-900">Create New Offer</h1> <p class="text-gray-600 mt-2">Create a new promotional offer for your customers</p></div> <div class="max-h-96 overflow-y-auto pr-2"><form class="space-y-8"><div class="bg-gray-50 rounded-xl p-6"><h2 class="text-xl font-semibold text-gray-900 mb-6 flex items-center"><span class="text-blue-600 mr-2">📝</span> Basic Information</h2> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label for="createTitle" class="block text-sm font-medium text-gray-700 mb-2">Offer Title *</label> <input type="text" id="createTitle" required placeholder="e.g., Summer Sale - 25% Off" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <div><label for="createBranch" class="block text-sm font-medium text-gray-700 mb-2">Target Branch</label> <select id="createBranch" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>All Branches</option><!></select></div></div> <div class="mt-6"><label for="createDescription" class="block text-sm font-medium text-gray-700 mb-2">Description</label> <textarea id="createDescription" rows="3" placeholder="Describe the offer details..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea></div></div> <div class="bg-gray-50 rounded-xl p-6"><h2 class="text-xl font-semibold text-gray-900 mb-6 flex items-center"><span class="text-green-600 mr-2">💰</span> Discount Settings</h2> <div class="grid grid-cols-1 md:grid-cols-3 gap-6"><div><label for="createDiscountPercentage" class="block text-sm font-medium text-gray-700 mb-2">Discount Percentage</label> <div class="relative"><input type="number" id="createDiscountPercentage" min="0" max="100" step="0.01" placeholder="25" class="w-full px-4 py-3 pr-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/> <span class="absolute right-3 top-3 text-gray-500">%</span></div></div> <div><label for="createDiscountAmount" class="block text-sm font-medium text-gray-700 mb-2">Fixed Discount Amount</label> <div class="relative"><input type="number" id="createDiscountAmount" min="0" step="0.01" placeholder="50" class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/> <span class="absolute right-3 top-3 text-gray-500">SAR</span></div></div> <div><label for="createMinimumPurchase" class="block text-sm font-medium text-gray-700 mb-2">Minimum Purchase</label> <div class="relative"><input type="number" id="createMinimumPurchase" min="0" step="0.01" placeholder="100" class="w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/> <span class="absolute right-3 top-3 text-gray-500">SAR</span></div></div></div></div> <div class="bg-gray-50 rounded-xl p-6"><h2 class="text-xl font-semibold text-gray-900 mb-6 flex items-center"><span class="text-purple-600 mr-2">📅</span> Validity Period</h2> <div class="grid grid-cols-1 md:grid-cols-2 gap-6"><div><label for="createValidFrom" class="block text-sm font-medium text-gray-700 mb-2">Valid From</label> <input type="date" id="createValidFrom" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <div><label for="createValidUntil" class="block text-sm font-medium text-gray-700 mb-2">Valid Until *</label> <input type="date" id="createValidUntil" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div></div></div> <div class="bg-gray-50 rounded-xl p-6"><h2 class="text-xl font-semibold text-gray-900 mb-6 flex items-center"><span class="text-orange-600 mr-2">📎</span> Visual Content</h2> <div class="grid grid-cols-1 md:grid-cols-2 gap-8"><div><label class="block text-sm font-medium text-gray-700 mb-3">Offer Image (PNG, JPG - Max 5MB)</label> <!> <input type="file" accept="image/*" class="mt-3 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/></div> <div><label class="block text-sm font-medium text-gray-700 mb-3">Offer Details PDF (Max 10MB)</label> <!> <input type="file" accept=".pdf" class="mt-3 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/></div></div></div> <div class="bg-gray-50 rounded-xl p-6"><h2 class="text-xl font-semibold text-gray-900 mb-6 flex items-center"><span class="text-gray-600 mr-2">⚙️</span> Additional Settings</h2> <div class="space-y-6"><div><label for="createMaxRedemptions" class="block text-sm font-medium text-gray-700 mb-2">Maximum Redemptions (Optional)</label> <input type="number" id="createMaxRedemptions" min="0" placeholder="Leave empty for unlimited" class="w-full md:w-64 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <div><label for="createTermsConditions" class="block text-sm font-medium text-gray-700 mb-2">Terms & Conditions</label> <textarea id="createTermsConditions" rows="4" placeholder="Enter terms and conditions for this offer..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea></div> <div class="flex items-center"><input type="checkbox" id="createIsActive" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"/> <label for="createIsActive" class="ml-2 text-sm font-medium text-gray-700">Offer is active and visible to customers</label></div></div></div></form></div> <div class="mt-8 flex items-center justify-between pt-6 border-t border-gray-200"><button type="button" class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">Cancel</button> <button type="button" class="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors flex items-center space-x-2"><!></button></div></div></div></div>'),$r=y('<div class="fixed top-4 right-4 z-50 max-w-sm"><div> </div></div>'),Lr=y('<div class="min-h-screen bg-gray-50"><div class="max-w-7xl mx-auto px-4 py-8"><div class="mb-8"><div><h1 class="text-3xl font-bold text-gray-900">Offers Management</h1> <p class="text-gray-600 mt-2">Manage all store offers and promotions</p></div></div> <div class="bg-white rounded-xl shadow-sm p-6 mb-6"><div class="grid grid-cols-1 md:grid-cols-4 gap-4"><div><label for="search" class="block text-sm font-medium text-gray-700 mb-2">Search Offers</label> <input type="text" id="search" placeholder="Search by title or description..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"/></div> <div><label for="branchFilter" class="block text-sm font-medium text-gray-700 mb-2"> </label> <select id="branchFilter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>All Branches</option><!></select></div> <div><label for="statusFilter" class="block text-sm font-medium text-gray-700 mb-2"> </label> <select id="statusFilter" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>All Status</option><option>Active</option><option>Expired</option><option>Inactive</option></select></div> <div><label for="itemsPerPage" class="block text-sm font-medium text-gray-700 mb-2">Items per page</label> <select id="itemsPerPage" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"><option>10</option><option>25</option><option>50</option></select></div></div></div> <div class="bg-white rounded-xl shadow-sm overflow-hidden"><!></div></div> <!> <!></div>');function ta(Nt,Rt){ur(Rt,!1);const ae=_(),pt=_(),ft=_();let j=_([]),Q=_([]),Ve=_(!1),T=_(""),N=_(""),M=_("all"),Ae=_(""),gt=_("success"),k=_(1),S=_(10),W=_(0),ie=_(!1),Ie=_(!1),l=_({title:"",description:"",selectedBranchId:"",discountPercentage:0,discountAmount:0,minimumPurchase:0,validFrom:"",validUntil:"",termsConditions:"",maxRedemptions:0,isActive:!0}),X=null,se=null,pe=_(""),fe=_("");vr(async()=>{console.log("Offers Management page mounted"),bt(),await Promise.all([zt(),be()]);const r=o=>{e(ie)&&o.key==="Escape"&&ge()};return document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}});function bt(){const r=new Date().toISOString().split("T")[0],o=new Date;o.setMonth(o.getMonth()+1);const s=o.toISOString().split("T")[0];O(l,e(l).validFrom=r),O(l,e(l).validUntil=s)}function ge(){v(ie,!1),$t()}function $t(){v(l,{title:"",description:"",selectedBranchId:"",discountPercentage:0,discountAmount:0,minimumPurchase:0,validFrom:"",validUntil:"",termsConditions:"",maxRedemptions:0,isActive:!0}),X=null,se=null,v(pe,""),v(fe,""),bt()}function Lt(r){const s=r.target.files?.[0];if(s){if(!s.type.startsWith("image/")){P("Please select a valid image file (PNG, JPG, JPEG)","error");return}if(s.size>5*1024*1024){P("Image file size must be less than 5MB","error");return}X=s;const m=new FileReader;m.onload=c=>{v(pe,c.target?.result)},m.readAsDataURL(s)}}function Vt(r){const s=r.target.files?.[0];if(s){if(s.type!=="application/pdf"){P("Please select a valid PDF file","error");return}if(s.size>10*1024*1024){P("PDF file size must be less than 10MB","error");return}se=s,v(fe,s.name)}}function qt(){X=null,v(pe,"")}function jt(){se=null,v(fe,"")}async function xt(r,o,s){try{const{data:m,error:c}=await K.storage.from(o).upload(s,r,{upsert:!0});if(c)throw c;const{data:b}=K.storage.from(o).getPublicUrl(s);return b.publicUrl}catch(m){return console.error(`Error uploading ${o}:`,m),null}}async function _t(){if(console.log("Create new offer called with data:",e(l)),!e(l).title?.trim()){P("Please enter an offer title","error"),document.getElementById("createTitle")?.focus();return}if(!e(l).validUntil){P("Please select a valid until date","error"),document.getElementById("createValidUntil")?.focus();return}const r=new Date().toISOString().split("T")[0];if(e(l).validUntil<r){P("Valid until date cannot be in the past","error"),document.getElementById("createValidUntil")?.focus();return}try{v(Ie,!0),console.log("Starting offer creation...");let o="",s="";if(X){console.log("Uploading image file:",X.name);const F=`offer-${Date.now()}.${X.name.split(".").pop()}`;o=await xt(X,"offer-images",F)||"",console.log("Image uploaded, URL:",o)}if(se){console.log("Uploading PDF file:",se.name);const F=`offer-${Date.now()}.pdf`;s=await xt(se,"offer-pdfs",F)||"",console.log("PDF uploaded, URL:",s)}const m={title:e(l).title.trim(),description:e(l).description?.trim()||null,branch_id:e(l).selectedBranchId||null,discount_percentage:Number(e(l).discountPercentage)||0,discount_amount:Number(e(l).discountAmount)||0,minimum_purchase:Number(e(l).minimumPurchase)||0,valid_from:e(l).validFrom||new Date().toISOString().split("T")[0],valid_until:e(l).validUntil,image_url:o||null,pdf_url:s||null,terms_conditions:e(l).termsConditions?.trim()||null,max_redemptions:e(l).maxRedemptions?Number(e(l).maxRedemptions):null,is_active:!!e(l).isActive,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("Inserting offer data:",m);const{data:c,error:b}=await K.from("offers").insert(m).select();if(b)throw console.error("Supabase error:",b),new Error(`Database error: ${b.message}`);console.log("Offer created successfully:",c),P("Offer created successfully! 🎉","success"),ge(),await be()}catch(o){console.error("Error creating offer:",o),P(`Failed to create offer: ${o.message}`,"error")}finally{v(Ie,!1)}}async function zt(){try{console.log("Loading branches for filter dropdown...");const{data:r,error:o}=await K.from("branches").select("*").eq("is_active",!0).order("created_at");if(o)throw console.error("Error loading branches:",o),o;console.log("Branches loaded:",r?.length||0),v(Q,(r||[]).map(s=>{const m=s.branch_name||s.name||s.title||`Branch ${s.id?.slice(0,8)}`;return{id:s.id,name:m}}))}catch(r){console.error("Error loading branches:",r),P(`Failed to load branches: ${r.message}`,"error")}}async function be(){try{v(Ve,!0),console.log("Loading offers with filters:",{selectedBranch:e(N),statusFilter:e(M),searchQuery:e(T)});let r=K.from("offers").select("*",{count:"exact"}).order("created_at",{ascending:!1});e(N)&&(r=r.eq("branch_id",e(N))),e(M)==="active"?r=r.eq("is_active",!0).gte("valid_until",new Date().toISOString().split("T")[0]):e(M)==="expired"?r=r.lt("valid_until",new Date().toISOString().split("T")[0]):e(M)==="inactive"&&(r=r.eq("is_active",!1)),e(T).trim()&&(r=r.or(`title.ilike.%${e(T)}%,description.ilike.%${e(T)}%`));const o=(e(k)-1)*e(S),s=o+e(S)-1;r=r.range(o,s);const{data:m,error:c,count:b}=await r;if(c)throw console.error("Supabase error:",c),c;console.log("Loaded offers:",m?.length||0),v(j,m||[]),v(W,b||0),e(j).length>0&&await Gt()}catch(r){console.error("Error loading offers:",r),P(`Failed to load offers: ${r.message}`,"error")}finally{v(Ve,!1)}}async function Gt(){try{const r=e(j).filter(c=>c.branch_id).map(c=>c.branch_id);if(r.length===0)return;const{data:o,error:s}=await K.from("branches").select("*").in("id",r);if(s){console.error("Error loading branch info:",s);return}const m=new Map;o?.forEach(c=>{const b=c.branch_name||c.name||c.title||`Branch ${c.id?.slice(0,8)}`;m.set(c.id,{...c,display_name:b})}),v(j,e(j).map(c=>({...c,branch_info:c.branch_id?m.get(c.branch_id):null})))}catch(r){console.error("Error loading branch info:",r)}}async function Jt(r,o){if(confirm(`Are you sure you want to delete "${o}"? This action cannot be undone.`))try{const{error:s}=await K.from("offers").delete().eq("id",r);if(s)throw s;P("Offer deleted successfully","success"),await be()}catch(s){console.error("Error deleting offer:",s),P("Failed to delete offer","error")}}async function Ht(r,o){try{const{error:s}=await K.from("offers").update({is_active:!o,updated_at:new Date().toISOString()}).eq("id",r);if(s)throw s;P(`Offer ${o?"deactivated":"activated"} successfully`,"success"),await be()}catch(s){console.error("Error updating offer status:",s),P("Failed to update offer status","error")}}function P(r,o){v(Ae,r),v(gt,o),setTimeout(()=>{v(Ae,"")},5e3)}function Kt(r){const o=new Date,s=new Date(r.valid_until);return r.is_active?s<o?{label:"Expired",color:"bg-red-100 text-red-800"}:{label:"Active",color:"bg-green-100 text-green-800"}:{label:"Inactive",color:"bg-gray-100 text-gray-800"}}function Qt(r){return r.branch_info?r.branch_info.display_name||"Unknown Branch":r.branch_id?"Loading...":"All Branches"}function Wt(r){return new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}Fe(()=>(e(T),e(N),e(M),e(S)),()=>{(e(T)!==void 0||e(N)!==void 0||e(M)!==void 0||e(S)!==void 0)&&(v(k,1),typeof window<"u"&&be())}),Fe(()=>e(ie),()=>{e(ie)!==void 0&&console.log("🎭 MODAL STATE CHANGED:",e(ie))}),Fe(()=>(e(W),e(S)),()=>{v(ae,Math.ceil(e(W)/e(S)))}),Fe(()=>(e(k),e(ae)),()=>{v(pt,e(k)<e(ae))}),Fe(()=>e(k),()=>{v(ft,e(k)>1)}),mr(),yr();var qe=Lr();pr(r=>{gr.title="Offers Management - Admin Panel"});var je=a(qe),ze=i(a(je),2),yt=a(ze),Ge=a(yt),ht=i(a(Ge),2);q(ht),t(Ge);var Je=i(Ge,2),He=a(Je),Xt=a(He);t(He);var Ke=i(He,2);h(()=>{e(N),Re(()=>{e(Q)})});var Qe=a(Ke);Qe.value=Qe.__value="";var Yt=i(Qe);ut(Yt,1,()=>e(Q),mt,(r,o)=>{var s=wr(),m=a(s,!0);t(s);var c={};h(()=>{w(m,(e(o),u(()=>e(o).name))),c!==(c=(e(o),u(()=>e(o).id)))&&(s.value=(s.__value=(e(o),u(()=>e(o).id)))??"")}),p(r,s)}),t(Ke),t(Je);var We=i(Je,2),Xe=a(We),Zt=a(Xe);t(Xe);var Ye=i(Xe,2);h(()=>{e(M),Re(()=>{})});var Ze=a(Ye);Ze.value=Ze.__value="all";var et=i(Ze);et.value=et.__value="active";var tt=i(et);tt.value=tt.__value="expired";var wt=i(tt);wt.value=wt.__value="inactive",t(Ye),t(We);var Pt=i(We,2),rt=i(a(Pt),2);h(()=>{e(S),Re(()=>{})});var at=a(rt);at.value=at.__value=10;var it=i(at);it.value=it.__value=25;var kt=i(it);kt.value=kt.__value=50,t(rt),t(Pt),t(yt),t(ze);var Dt=i(ze,2),er=a(Dt);{var tr=r=>{var o=Pr();p(r,o)},rr=r=>{var o=Ut(),s=ct(o);{var m=b=>{var F=kr(),U=i(a(F),4),z=a(U,!0);t(U),t(F),h(()=>w(z,e(T)||e(N)||e(M)!=="all"?"Try adjusting your filters":"Use the Create Offer page to add your first offer")),p(b,F)},c=b=>{var F=Ir(),U=ct(F),z=a(U),oe=i(a(z));ut(oe,5,()=>e(j),mt,(G,d)=>{var C=Fr();const A=br(()=>(e(d),u(()=>Kt(e(d)))));var Y=a(C),J=a(Y),R=a(J);{var $=f=>{var x=Dr();h(()=>{$e(x,"src",(e(d),u(()=>e(d).image_url))),$e(x,"alt",(e(d),u(()=>e(d).title)))}),p(f,x)},le=f=>{var x=Or();p(f,x)};I(R,f=>{e(d),u(()=>e(d).image_url)?f($):f(le,!1)})}var L=i(R,2),H=a(L),Be=a(H,!0);t(H);var ye=i(H,2);{var Me=f=>{var x=Sr(),De=a(x);t(x),h(Oe=>w(De,`${Oe??""}...`),[()=>(e(d),u(()=>e(d).description.slice(0,60)))]),p(f,x)};I(ye,f=>{e(d),u(()=>e(d).description)&&f(Me)})}t(L),t(J),t(Y);var ne=i(Y),Ue=a(ne,!0);t(ne);var de=i(ne),Ce=a(de);{var he=f=>{var x=vt();h(()=>w(x,`${e(d),u(()=>e(d).discount_percentage)??""}% off`)),p(f,x)},Ee=f=>{var x=Ut(),De=ct(x);{var Oe=V=>{var te=vt();h(()=>w(te,`${e(d),u(()=>e(d).discount_amount)??""} SAR off`)),p(V,te)},lt=V=>{var te=vt("No discount");p(V,te)};I(De,V=>{e(d),u(()=>e(d).discount_amount>0)?V(Oe):V(lt,!1)},!0)}p(f,x)};I(Ce,f=>{e(d),u(()=>e(d).discount_percentage>0)?f(he):f(Ee,!1)})}t(de);var Z=i(de),Te=a(Z,!0);t(Z);var ce=i(Z),ve=a(ce),we=a(ve,!0);t(ve),t(ce);var Pe=i(ce),ue=a(Pe),ke=a(ue),ee=i(ke,2),st=a(ee,!0);t(ee);var ot=i(ee,2);t(ue),t(Pe),t(C),h((f,x)=>{w(Be,(e(d),u(()=>e(d).title))),w(Ue,f),w(Te,x),Tt(ve,1,`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Et(e(A)),u(()=>e(A).color)??""}`),w(we,(Et(e(A)),u(()=>e(A).label))),$e(ee,"title",`${e(d),u(()=>e(d).is_active?"Deactivate":"Activate")??""} Offer`),w(st,(e(d),u(()=>e(d).is_active?"🔽":"🔼")))},[()=>(e(d),u(()=>Qt(e(d)))),()=>(e(d),u(()=>Wt(e(d).valid_until)))]),D("click",ke,()=>hr(`/admin/edit-offer/${e(d).id}`)),D("click",ee,()=>Ht(e(d).id,e(d).is_active)),D("click",ot,()=>Jt(e(d).id,e(d).title)),p(G,C)}),t(oe),t(z),t(U);var xe=i(U,2);{var _e=G=>{var d=Ar(),C=a(d),A=a(C),Y=a(A);t(A);var J=i(A,2),R=a(J),$=i(R,2),le=a($);t($);var L=i($,2);t(J),t(C),t(d),h(H=>{w(Y,`Showing ${(e(k)-1)*e(S)+1} to ${H??""} of ${e(W)??""} offers`),R.disabled=!e(ft),w(le,`Page ${e(k)??""} of ${e(ae)??""}`),L.disabled=!e(pt)},[()=>(e(k),e(S),e(W),u(()=>Math.min(e(k)*e(S),e(W))))]),D("click",R,()=>v(k,Math.max(1,e(k)-1))),D("click",L,()=>v(k,Math.min(e(ae),e(k)+1))),p(G,d)};I(xe,G=>{e(ae)>1&&G(_e)})}p(b,F)};I(s,b=>{e(j),u(()=>e(j).length===0)?b(m):b(c,!1)},!0)}p(r,o)};I(er,r=>{e(Ve)?r(tr):r(rr,!1)})}t(Dt),t(je);var Ot=i(je,2);{var ar=r=>{var o=Rr(),s=a(o),m=a(s),c=i(m,2),b=a(c),F=a(b);t(b);var U=i(b,4),z=a(U),oe=a(z),xe=i(a(oe),2),_e=a(xe),G=i(a(_e),2);q(G),t(_e);var d=i(_e,2),C=i(a(d),2);h(()=>{e(l),Re(()=>{e(Q)})});var A=a(C);A.value=A.__value="";var Y=i(A);ut(Y,1,()=>e(Q),mt,(n,g)=>{var B=Br(),re=a(B,!0);t(B);var Se={};h(()=>{w(re,(e(g),u(()=>e(g).name))),Se!==(Se=(e(g),u(()=>e(g).id)))&&(B.value=(B.__value=(e(g),u(()=>e(g).id)))??"")}),p(n,B)}),t(C),t(d),t(xe);var J=i(xe,2),R=i(a(J),2);Ct(R),t(J),t(oe);var $=i(oe,2),le=i(a($),2),L=a(le),H=i(a(L),2),Be=a(H);q(Be),me(2),t(H),t(L);var ye=i(L,2),Me=i(a(ye),2),ne=a(Me);q(ne),me(2),t(Me),t(ye);var Ue=i(ye,2),de=i(a(Ue),2),Ce=a(de);q(Ce),me(2),t(de),t(Ue),t(le),t($);var he=i($,2),Ee=i(a(he),2),Z=a(Ee),Te=i(a(Z),2);q(Te),t(Z);var ce=i(Z,2),ve=i(a(ce),2);q(ve),t(ce),t(Ee),t(he);var we=i(he,2),Pe=i(a(we),2),ue=a(Pe),ke=i(a(ue),2);{var ee=n=>{var g=Mr(),B=a(g),re=i(B,2);t(g),h(()=>$e(B,"src",e(pe))),D("click",re,qt),p(n,g)},st=n=>{var g=Ur();p(n,g)};I(ke,n=>{e(pe)?n(ee):n(st,!1)})}var ot=i(ke,2);t(ue);var f=i(ue,2),x=i(a(f),2);{var De=n=>{var g=Cr(),B=a(g),re=i(a(B),2),Se=a(re),dr=a(Se,!0);t(Se),me(2),t(re);var cr=i(re,2);t(B),t(g),h(()=>w(dr,e(fe))),D("click",cr,jt),p(n,g)},Oe=n=>{var g=Er();p(n,g)};I(x,n=>{e(fe)?n(De):n(Oe,!1)})}var lt=i(x,2);t(f),t(Pe),t(we);var V=i(we,2),te=i(a(V),2),nt=a(te),St=i(a(nt),2);q(St),t(nt);var dt=i(nt,2),Ft=i(a(dt),2);Ct(Ft),t(dt);var At=i(dt,2),It=a(At);q(It),me(2),t(At),t(te),t(V),t(z),t(U);var Bt=i(U,2),Mt=a(Bt),Ne=i(Mt,2),or=a(Ne);{var lr=n=>{var g=Tr();me(2),p(n,g)},nr=n=>{var g=Nr();p(n,g)};I(or,n=>{e(Ie)?n(lr):n(nr,!1)})}t(Ne),t(Bt),t(c),t(s),t(o),h(()=>Ne.disabled=e(Ie)),D("click",m,ge),D("click",F,ge),E(G,()=>e(l).title,n=>O(l,e(l).title=n)),Le(C,()=>e(l).selectedBranchId,n=>O(l,e(l).selectedBranchId=n)),E(R,()=>e(l).description,n=>O(l,e(l).description=n)),E(Be,()=>e(l).discountPercentage,n=>O(l,e(l).discountPercentage=n)),E(ne,()=>e(l).discountAmount,n=>O(l,e(l).discountAmount=n)),E(Ce,()=>e(l).minimumPurchase,n=>O(l,e(l).minimumPurchase=n)),E(Te,()=>e(l).validFrom,n=>O(l,e(l).validFrom=n)),E(ve,()=>e(l).validUntil,n=>O(l,e(l).validUntil=n)),D("change",ot,Lt),D("change",lt,Vt),E(St,()=>e(l).maxRedemptions,n=>O(l,e(l).maxRedemptions=n)),E(Ft,()=>e(l).termsConditions,n=>O(l,e(l).termsConditions=n)),xr(It,()=>e(l).isActive,n=>O(l,e(l).isActive=n)),D("submit",z,_r(_t)),D("click",Mt,ge),D("click",Ne,_t),p(r,o)};I(Ot,r=>{e(ie)&&r(ar)})}var ir=i(Ot,2);{var sr=r=>{var o=$r(),s=a(o),m=a(s,!0);t(s),t(o),h(()=>{Tt(s,1,`rounded-lg p-4 shadow-lg ${e(gt)==="success"?"bg-green-500":"bg-red-500"} text-white`),w(m,e(Ae))}),p(r,o)};I(ir,r=>{e(Ae)&&r(sr)})}t(qe),h(()=>{w(Xt,`Branch (${e(Q),u(()=>e(Q).length)??""} loaded)`),w(Zt,`Status (${e(W)??""} total)`)}),E(ht,()=>e(T),r=>v(T,r)),Le(Ke,()=>e(N),r=>v(N,r)),Le(Ye,()=>e(M),r=>v(M,r)),Le(rt,()=>e(S),r=>v(S,r)),p(Nt,qe),fr()}export{ta as component};
